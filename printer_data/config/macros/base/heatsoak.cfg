[gcode_macro _HEAT_WAIT]
description: Heating cycle waiting routine
gcode:
    {% set led_name = printer["gcode_macro _leds_vars"].logo_led_name %}
    {% set minutes = params.MINUTES|default(10)|int %}
    {% set msg = params.MSG|default("Heat Soak...")|string %}
    {% for i in range(0, minutes) %}
        M117 {msg} {minutes-i} minute remaining.
        {% for s in range(0, 60) %}
            SET_LED LED={led_name} INDEX=1 RED=1 GREEN=0.2392 BLUE=0 WHITE=0
            SET_LED LED={led_name} INDEX=2 RED=1 GREEN=0.2392 BLUE=0 WHITE=0
            SET_LED LED={led_name} INDEX=3 RED=0.051 GREEN=0.0118 BLUE=0 WHITE=0
            G4 P500
            SET_LED LED={led_name} INDEX=1 RED=1 GREEN=0.2392 BLUE=0 WHITE=0
            SET_LED LED={led_name} INDEX=2 RED=0.051 GREEN=0.0118 BLUE=0 WHITE=0
            SET_LED LED={led_name} INDEX=3 RED=1 GREEN=0.2392 BLUE=0 WHITE=0
            G4 P500
        {% endfor %}
    {% endfor %}

    M117
    RESPOND TYPE=COMMAND MSG="{msg} Finished."
